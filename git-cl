#!/bin/sh
# Copyright (c) 2010 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

base_dir=$(dirname "$0")
repo="$base_dir/git-cl-repo"
url="http://src.chromium.org/git/git-cl.git"
cur_url=$(git config -f "$repo/.git/config" remote.origin.url)

if [ -e "$repo" -a "$cur_url" != "$url" ]; then
  cat <<EOF
$repo
is tracking a non-default remote repository:

  default: $url
  yours:   $cur_url

This is intended to be an automatically-updating, read-only repository.
Please create a separate repository for making changes to git-cl, move your
modifications there, and then run:
  rm -rf $repo
EOF
  exit 1
fi

if [ ! -f "$repo/git-cl" ]; then
  git clone $url $repo -q
fi

$repo/git-cl "$@"
